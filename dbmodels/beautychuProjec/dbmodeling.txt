-- 고객
ALTER TABLE CUSTOMER
	DROP FOREIGN KEY FK_USER_TO_CUSTOMER; -- 사용자 -> 고객

-- 리뷰
ALTER TABLE REVIEW
	DROP FOREIGN KEY FK_STYLE_TO_REVIEW; -- 스타일 -> 리뷰

-- 리뷰
ALTER TABLE REVIEW
	DROP FOREIGN KEY FK_CUSTOMER_TO_REVIEW; -- 고객 -> 리뷰

-- 스타일
ALTER TABLE STYLE
	DROP FOREIGN KEY FK_SHOP_TO_STYLE; -- 샵 -> 스타일

-- 샵
ALTER TABLE SHOP
	DROP FOREIGN KEY FK_USER_TO_SHOP; -- 사용자 -> 샵

-- 쿠폰
ALTER TABLE COUPON
	DROP FOREIGN KEY FK_SHOP_TO_COUPON; -- 샵 -> 쿠폰

-- 가격표
ALTER TABLE TABLE
	DROP FOREIGN KEY FK_SHOP_TO_TABLE; -- 샵 -> 가격표

-- 쿠폰발급
ALTER TABLE ISSUE
	DROP FOREIGN KEY FK_COUPON_TO_ISSUE; -- 쿠폰 -> 쿠폰발급

-- 쿠폰발급
ALTER TABLE ISSUE
	DROP FOREIGN KEY FK_CUSTOMER_TO_ISSUE; -- 고객 -> 쿠폰발급

-- 샵사진
ALTER TABLE SHOPPHOTO
	DROP FOREIGN KEY FK_SHOP_TO_SHOPPHOTO; -- 샵 -> 샵사진

-- 스타일사진
ALTER TABLE STYLEPHOTO
	DROP FOREIGN KEY FK_STYLE_TO_STYLEPHOTO; -- 스타일 -> 스타일사진

-- 고객
ALTER TABLE CUSTOMER
	DROP PRIMARY KEY; -- 고객 기본키

-- 리뷰
ALTER TABLE REVIEW
	DROP PRIMARY KEY; -- 리뷰 기본키

-- 스타일
ALTER TABLE STYLE
	DROP PRIMARY KEY; -- 스타일 기본키

-- 샵
ALTER TABLE SHOP
	DROP PRIMARY KEY; -- 샵 기본키

-- 쿠폰
ALTER TABLE COUPON
	DROP PRIMARY KEY; -- 쿠폰 기본키

-- 가격표
ALTER TABLE TABLE
	DROP PRIMARY KEY; -- 가격표 기본키

-- 사용자
ALTER TABLE USER
	DROP PRIMARY KEY; -- 사용자 기본키

-- 쿠폰발급
ALTER TABLE ISSUE
	DROP PRIMARY KEY; -- 쿠폰발급 기본키

-- 샵사진
ALTER TABLE SHOPPHOTO
	DROP PRIMARY KEY; -- 샵사진 기본키

-- 스타일사진
ALTER TABLE STYLEPHOTO
	DROP PRIMARY KEY; -- 스타일사진 기본키

-- 고객 유니크 인덱스
DROP INDEX UIX_CUSTOMER ON CUSTOMER;

-- 샵 유니크 인덱스
DROP INDEX UIX_SHOP ON SHOP;

-- 사용자 유니크 인덱스
DROP INDEX UIX_USER ON USER;

-- 사용자 유니크 인덱스2
DROP INDEX UIX_USER2 ON USER;

-- 고객
DROP TABLE IF EXISTS CUSTOMER RESTRICT;

-- 리뷰
DROP TABLE IF EXISTS REVIEW RESTRICT;

-- 스타일
DROP TABLE IF EXISTS STYLE RESTRICT;

-- 샵
DROP TABLE IF EXISTS SHOP RESTRICT;

-- 쿠폰
DROP TABLE IF EXISTS COUPON RESTRICT;

-- 가격표
DROP TABLE IF EXISTS TABLE RESTRICT;

-- 사용자
DROP TABLE IF EXISTS USER RESTRICT;

-- 쿠폰발급
DROP TABLE IF EXISTS ISSUE RESTRICT;

-- 샵사진
DROP TABLE IF EXISTS SHOPPHOTO RESTRICT;

-- 스타일사진
DROP TABLE IF EXISTS STYLEPHOTO RESTRICT;

-- 내 스키마
DROP SCHEMA IF EXISTS MY_SCHEMA;

-- 내 스키마
CREATE SCHEMA MY_SCHEMA;

-- 고객
CREATE TABLE CUSTOMER (
	EMAIL        VARCHAR(40)  NOT NULL, -- 이메일
	COUPONCODE   VARCHAR(100) NOT NULL, -- 쿠폰코드
	PROFILEPHOTO VARCHAR(255) NOT NULL  -- 프로필사진
);

-- 고객
ALTER TABLE CUSTOMER
	ADD CONSTRAINT PK_CUSTOMER -- 고객 기본키
		PRIMARY KEY (
			EMAIL -- 이메일
		);

-- 고객 유니크 인덱스
CREATE UNIQUE INDEX UIX_CUSTOMER
	ON CUSTOMER ( -- 고객
	);

-- 리뷰
CREATE TABLE REVIEW (
	REVIEWNO   INTEGER        NOT NULL, -- 리뷰번호
	STYLENO    INTEGER        NOT NULL, -- 스타일번호
	NICKNAME   VARCHAR(50)    NOT NULL, -- 닉네임
	CONTENT    VARCHAR(10000) NOT NULL, -- 내용
	STAR       INTEGER        NOT NULL, -- 별점
	REPORTDATE DATE           NOT NULL, -- 작성일
	EMAIL      VARCHAR(40)    NOT NULL  -- 이메일
);

-- 리뷰
ALTER TABLE REVIEW
	ADD CONSTRAINT PK_REVIEW -- 리뷰 기본키
		PRIMARY KEY (
			REVIEWNO -- 리뷰번호
		);

-- 스타일
CREATE TABLE STYLE (
	STYLENO     INTEGER        NOT NULL, -- 스타일번호
	PEOPLE      VARCHAR(255)   NOT NULL, -- 연예인여부
	GENDER      VARCHAR(255)   NOT NULL, -- 성별
	STYLELENGTH VARCHAR(50)    NOT NULL, -- 기장분류
	STYLENAME   VARCHAR(50)    NOT NULL, -- 스타일 이름
	STYLEINTRO  VARCHAR(10000) NOT NULL, -- 스타일 소개
	SKILLTIME   TIME           NOT NULL, -- 시술시간
	PRICE       INTEGER        NOT NULL, -- 가격
	EMAIL       VARCHAR(40)    NOT NULL  -- 이메일
);

-- 스타일
ALTER TABLE STYLE
	ADD CONSTRAINT PK_STYLE -- 스타일 기본키
		PRIMARY KEY (
			STYLENO -- 스타일번호
		);

-- 샵
CREATE TABLE SHOP (
	EMAIL      VARCHAR(40)    NOT NULL, -- 이메일
	LICENSEENO VARCHAR(70)    NOT NULL, -- 사업자번호
	SHOPNAME   VARCHAR(50)    NOT NULL, -- 샵이름
	SHOPADDR   VARCHAR(255)   NOT NULL, -- 샵주소
	SHOPTEL    VARCHAR(30)    NOT NULL, -- 샵전화번호
	SHOPINTRO  VARCHAR(10000) NOT NULL  -- 샵소개
);

-- 샵
ALTER TABLE SHOP
	ADD CONSTRAINT PK_SHOP -- 샵 기본키
		PRIMARY KEY (
			EMAIL -- 이메일
		);

-- 샵 유니크 인덱스
CREATE UNIQUE INDEX UIX_SHOP
	ON SHOP ( -- 샵
		LICENSEENO ASC -- 사업자번호
	);

-- 쿠폰
CREATE TABLE COUPON (
	COUPONCODE VARCHAR(100)   NOT NULL, -- 쿠폰코드
	TIMELIMIT  DATE           NOT NULL, -- 기한
	DISCOUNT   INTEGER        NOT NULL, -- 할인율
	COST       INTEGER        NOT NULL, -- 원가
	C_CONTENT  VARCHAR(10000) NOT NULL, -- 쿠폰내용
	EMAIL      VARCHAR(40)    NOT NULL  -- 이메일
);

-- 쿠폰
ALTER TABLE COUPON
	ADD CONSTRAINT PK_COUPON -- 쿠폰 기본키
		PRIMARY KEY (
			COUPONCODE -- 쿠폰코드
		);

-- 가격표
CREATE TABLE TABLE (
	TABLENO  INTEGER     NOT NULL, -- 표번호
	SKILL    VARCHAR(50) NOT NULL, -- 시술이름
	LENGTH   VARCHAR(50) NOT NULL, -- 기장
	MINPRICE INTEGER     NOT NULL, -- 최소가격
	MAXPRICE INTEGER     NULL,     -- 최고가격
	EMAIL    VARCHAR(40) NOT NULL  -- 이메일
);

-- 가격표
ALTER TABLE TABLE
	ADD CONSTRAINT PK_TABLE -- 가격표 기본키
		PRIMARY KEY (
			TABLENO -- 표번호
		);

-- 사용자
CREATE TABLE USER (
	EMAIL    VARCHAR(40)  NOT NULL, -- 이메일
	USERNO   INTEGER      NOT NULL, -- 사용자고유번호
	PHONE    VARCHAR(30)  NULL,     -- 전화
	ADDR     VARCHAR(255) NULL,     -- 주소
	NAME     VARCHAR(50)  NOT NULL, -- 닉네임
	PASSWORD VARCHAR(30)  NOT NULL  -- 비밀번호
);

-- 사용자
ALTER TABLE USER
	ADD CONSTRAINT PK_USER -- 사용자 기본키
		PRIMARY KEY (
			EMAIL -- 이메일
		);

-- 사용자 유니크 인덱스
CREATE UNIQUE INDEX UIX_USER
	ON USER ( -- 사용자
		EMAIL ASC -- 이메일
	);

-- 사용자 유니크 인덱스2
CREATE UNIQUE INDEX UIX_USER2
	ON USER ( -- 사용자
		USERNO ASC -- 사용자고유번호
	);

-- 쿠폰발급
CREATE TABLE ISSUE (
	COUPONCODE VARCHAR(100) NOT NULL, -- 쿠폰코드
	EMAIL      VARCHAR(40)  NOT NULL, -- 이메일
	ISSUEDATE  DATE         NOT NULL, -- 발급일
	USEDATE    DATE         NULL      -- 사용일
);

-- 쿠폰발급
ALTER TABLE ISSUE
	ADD CONSTRAINT PK_ISSUE -- 쿠폰발급 기본키
		PRIMARY KEY (
			COUPONCODE -- 쿠폰코드
		);

-- 샵사진
CREATE TABLE SHOPPHOTO (
	SHOPPHOTONO VARCHAR(100) NOT NULL, -- 샵사진일련번호
	SHOPPHOTO   VARCHAR(255) NOT NULL, -- 샵사진
	EMAIL       VARCHAR(40)  NOT NULL  -- 이메일
);

-- 샵사진
ALTER TABLE SHOPPHOTO
	ADD CONSTRAINT PK_SHOPPHOTO -- 샵사진 기본키
		PRIMARY KEY (
			SHOPPHOTONO -- 샵사진일련번호
		);

-- 스타일사진
CREATE TABLE STYLEPHOTO (
	STYLEPHOTONO VARCHAR(100) NOT NULL, -- 스타일사진일련번호
	STYLENO      INTEGER      NOT NULL, -- 스타일번호
	STYLEPHOTO   VARCHAR(255) NOT NULL  -- 스타일사진
);

-- 스타일사진
ALTER TABLE STYLEPHOTO
	ADD CONSTRAINT PK_STYLEPHOTO -- 스타일사진 기본키
		PRIMARY KEY (
			STYLEPHOTONO -- 스타일사진일련번호
		);

-- 고객
ALTER TABLE CUSTOMER
	ADD CONSTRAINT FK_USER_TO_CUSTOMER -- 사용자 -> 고객
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES USER ( -- 사용자
			EMAIL -- 이메일
		);

-- 리뷰
ALTER TABLE REVIEW
	ADD CONSTRAINT FK_STYLE_TO_REVIEW -- 스타일 -> 리뷰
		FOREIGN KEY (
			STYLENO -- 스타일번호
		)
		REFERENCES STYLE ( -- 스타일
			STYLENO -- 스타일번호
		);

-- 리뷰
ALTER TABLE REVIEW
	ADD CONSTRAINT FK_CUSTOMER_TO_REVIEW -- 고객 -> 리뷰
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES CUSTOMER ( -- 고객
			EMAIL -- 이메일
		);

-- 스타일
ALTER TABLE STYLE
	ADD CONSTRAINT FK_SHOP_TO_STYLE -- 샵 -> 스타일
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES SHOP ( -- 샵
			EMAIL -- 이메일
		);

-- 샵
ALTER TABLE SHOP
	ADD CONSTRAINT FK_USER_TO_SHOP -- 사용자 -> 샵
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES USER ( -- 사용자
			EMAIL -- 이메일
		);

-- 쿠폰
ALTER TABLE COUPON
	ADD CONSTRAINT FK_SHOP_TO_COUPON -- 샵 -> 쿠폰
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES SHOP ( -- 샵
			EMAIL -- 이메일
		);

-- 가격표
ALTER TABLE TABLE
	ADD CONSTRAINT FK_SHOP_TO_TABLE -- 샵 -> 가격표
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES SHOP ( -- 샵
			EMAIL -- 이메일
		);

-- 쿠폰발급
ALTER TABLE ISSUE
	ADD CONSTRAINT FK_COUPON_TO_ISSUE -- 쿠폰 -> 쿠폰발급
		FOREIGN KEY (
			COUPONCODE -- 쿠폰코드
		)
		REFERENCES COUPON ( -- 쿠폰
			COUPONCODE -- 쿠폰코드
		);

-- 쿠폰발급
ALTER TABLE ISSUE
	ADD CONSTRAINT FK_CUSTOMER_TO_ISSUE -- 고객 -> 쿠폰발급
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES CUSTOMER ( -- 고객
			EMAIL -- 이메일
		);

-- 샵사진
ALTER TABLE SHOPPHOTO
	ADD CONSTRAINT FK_SHOP_TO_SHOPPHOTO -- 샵 -> 샵사진
		FOREIGN KEY (
			EMAIL -- 이메일
		)
		REFERENCES SHOP ( -- 샵
			EMAIL -- 이메일
		);

-- 스타일사진
ALTER TABLE STYLEPHOTO
	ADD CONSTRAINT FK_STYLE_TO_STYLEPHOTO -- 스타일 -> 스타일사진
		FOREIGN KEY (
			STYLENO -- 스타일번호
		)
		REFERENCES STYLE ( -- 스타일
			STYLENO -- 스타일번호
		);